{% extends "base.html" %}
{% block title %}ğŸ›  ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ{% endblock %}
{% block content %}
<h2>ğŸ›  ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h2>

<!-- âœ… íšŒì› ê´€ë¦¬ -->
<h3>ğŸ‘¤ íšŒì› ê´€ë¦¬</h3>
<table border="1" cellpadding="5">
  <tr>
    <th>ì‚¬ìš©ìëª…</th>
    <th>ì†Œê°œê¸€</th>
    <th>ìƒíƒœ</th>
    <th>ê¸°ëŠ¥</th>
  </tr>
  {% for u in users %}
    <tr>
      <td>{{ u.username }}</td>
      <td>{{ u.bio or 'ì—†ìŒ' }}</td>
      <td>{{ u.status }}</td>
      <td>
        {% if u.status == 'active' %}
          <form method="post" action="{{ url_for('admin_suspend_user', user_id=u.id) }}" style="display:inline;">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit">ì •ì§€</button>
          </form>
        {% else %}
          <form method="post" action="{{ url_for('admin_restore_user', user_id=u.id) }}" style="display:inline;">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit">ë³µêµ¬</button>
          </form>
        {% endif %}
        <form method="post" action="{{ url_for('admin_clear_bio', user_id=u.id) }}" style="display:inline;">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
          <button type="submit">ì†Œê°œê¸€ ì‚­ì œ</button>
        </form>
      </td>
    </tr>
  {% endfor %}
</table>

<br>

<!-- âœ… ìƒí’ˆ ê´€ë¦¬ -->
<h3>ğŸ“¦ ìƒí’ˆ ê´€ë¦¬</h3>
<table border="1" cellpadding="5">
  <tr>
    <th>ìƒí’ˆëª…</th>
    <th>ì„¤ëª…</th>
    <th>ê°€ê²©</th>
    <th>íŒë§¤ì</th>
    <th>ì‚­ì œ ì—¬ë¶€</th>
    <th>ê¸°ëŠ¥</th>
  </tr>
  {% for p in products %}
    <tr>
      <td>{{ p.title }}</td>
      <td>{{ p.description }}</td>
      <td>{{ p.price }}</td>
      <td>{{ p.seller_username }}</td>
      <td>{{ 'ì‚­ì œë¨' if p.is_deleted else 'ì •ìƒ' }}</td>
      <td>
        {% if not p.is_deleted %}
          <form method="post" action="{{ url_for('delete_product_admin', product_id=p.id) }}" style="display:inline;">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit">ğŸ—‘ï¸ ì‚­ì œ</button>
          </form>
        {% else %}
          <em>ì‚­ì œ ì™„ë£Œ</em>
        {% endif %}
      </td>
    </tr>
  {% endfor %}
</table>


<br>

<!-- âœ… ì‹ ê³  ë‚´ì—­ ê´€ë¦¬ -->
<h3>ğŸ“‹ ì‹ ê³  ë‚´ì—­ ê´€ë¦¬</h3>

{% if reports %}
  <ul>
    {% for report in reports %}
      <li>
        <strong>ì‹ ê³ ì:</strong> {{ report.reporter_name }}<br>
        <strong>ì‹ ê³  ëŒ€ìƒ:</strong> {{ report.target_name }} ({{ report.target_type }})<br>
        <strong>ì‚¬ìœ :</strong> {{ report.reason }}<br>

        {% if report.target_type == 'user' and report.target_status != 'suspended' %}
          <form method="post" action="{{ url_for('admin_suspend_user', user_id=report.target_id) }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit">ğŸš« ìœ ì € ì •ì§€</button>
          </form>
        {% elif report.target_type == 'product' and report.product_deleted != 1 %}
          <form method="post" action="{{ url_for('delete_product_admin', product_id=report.target_id) }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit">ğŸ—‘ï¸ ìƒí’ˆ ì‚­ì œ</button>
          </form>
        {% else %}
          <em>âœ… ì¡°ì¹˜ ì™„ë£Œë¨</em>
        {% endif %}
        <hr>
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>ì‹ ê³  ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
{% endif %}

{% endblock %}
